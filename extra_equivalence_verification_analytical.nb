(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     39667,       1260]
NotebookOptionsPosition[     37713,       1215]
NotebookOutlinePosition[     38321,       1236]
CellTagsIndexPosition[     38278,       1233]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Comparing formulae", "Section",
 CellChangeTimes->{{3.955694509443303*^9, 3.9556945113153467`*^9}, {
  3.957230414898972*^9, 3.957230419179628*^9}, {3.9572308411054487`*^9, 
  3.95723084745161*^9}},ExpressionUUID->"c80aef83-a3f3-491a-8f72-\
c7615c496e41"],

Cell[TextData[{
 "Comparing path decomposition of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "11"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6b57c3c5-310e-42a1-9db7-e8875f8440da"],
 " to analytical expressions (\[OpenCurlyDoubleQuote]harmonic decomposition\
\[CloseCurlyDoubleQuote]) from Garcia-Suarez 2022 JMPS (can do up N=7, then \
it becomes too slow)"
}], "Text",
 CellChangeTimes->{{3.957454279345001*^9, 3.95745431825438*^9}, {
  3.957454438569929*^9, 3.957454476559966*^9}, {3.957454562505827*^9, 
  3.957454576928217*^9}},ExpressionUUID->"aacbe4da-c175-47a5-a41d-\
e6d53670c7db"],

Cell["Number of layers", "Text",
 CellChangeTimes->{{3.9572306523399477`*^9, 
  3.957230657498707*^9}},ExpressionUUID->"3a52fe1c-0b80-4f3c-8349-\
49ae622fc350"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NN", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.955694540888872*^9, 3.955694542675872*^9}, 
   3.955696473554948*^9, {3.9556968629127703`*^9, 3.955696863279666*^9}, {
   3.957230662768215*^9, 3.957230705227503*^9}, 3.957230739675767*^9, 
   3.957230850672089*^9, 3.957351912502982*^9, 3.957352087371106*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"43ec1f81-55d1-4b42-82ca-3ef8b7b9ead0"],

Cell[CellGroupData[{

Cell["Harmonic decomposition", "Subsubsection",
 CellChangeTimes->{{3.957454481948522*^9, 
  3.957454485825664*^9}},ExpressionUUID->"1bc80a9b-7e38-4c1d-86dc-\
fed53810c14b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "maximum", " ", "number", " ", "of", " ", "tangents", " ", "in", " ", 
    "any", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"maxNumberTerms", "=", 
     RowBox[{"Floor", "[", 
      RowBox[{"NN", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "number", " ", "of", " ", "factors", " ", "in", " ", "each", " ", "group",
      " ", "of", " ", "expressions"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numberTerms", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "#"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       FractionBox[
        RowBox[{"Floor", "[", 
         RowBox[{"NN", ",", "2"}], "]"}], "2"], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "number", " ", "of", " ", "addends", " ", "belonging", " ", "to", " ", 
     "each", " ", "group"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numberAddends", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{"NN", ",", "#"}], "]"}], "&"}], "/@", "numberTerms"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexVectors", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NN", ">", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"NN", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], "&"}], "/@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"numberTerms", ",", "numberAddends"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexSets", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Permutations", "[", "#", "]"}], "&"}], "/@", 
        "indexVectors"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"anTF", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"layers", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"indexSets", "[", 
            RowBox[{"[", "term", "]"}], "]"}], ",", "1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Zs", "=", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "#"], "&"}], "/@", "layers"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortedZs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Zs", "[", 
           RowBox[{"[", 
            RowBox[{"#", ";;", " ", ";;", "2"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"anTF", "=", 
        RowBox[{"anTF", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"Length", "[", "layers", "]"}], "/", "2"}]], "*", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{"Times", "@@", 
             RowBox[{"sortedZs", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], 
            RowBox[{"Times", "@@", 
             RowBox[{"sortedZs", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]], ")"}], 
          RowBox[{"Times", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Tan", "[", 
               RowBox[{
                SubscriptBox["k", "#"], 
                SubscriptBox["l", "#"]}], "]"}], "&"}], "/@", "layers"}], 
            ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"term", ",", "1", ",", 
        RowBox[{"Length", "@", "indexSets"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"anTF", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["k", "#"], 
             SubscriptBox["l", "#"]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NN", "]"}]}], ")"}]}], ")"}], "*", 
      "anTF"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"oldMode", "=", 
     RowBox[{"Expand", "[", "anTF", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Framed", "[", "oldMode", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.955694559701873*^9, {3.955695667786427*^9, 3.9556957131448107`*^9}, 
   3.955695755432063*^9, {3.955696136465448*^9, 3.95569615329709*^9}, {
   3.955696377776297*^9, 3.955696396943149*^9}, {3.957230447946179*^9, 
   3.957230470244735*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"93b09dea-28a1-4425-b63b-b7ad325fc56f"],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "1"], " ", 
      SubscriptBox["l", "1"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "2"], " ", 
      SubscriptBox["l", "2"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["l", "3"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "4"], " ", 
      SubscriptBox["l", "4"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "5"], " ", 
      SubscriptBox["l", "5"]}], "]"}]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     SubscriptBox["k", "1"]}], 
    SubscriptBox["k", "2"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     SubscriptBox["k", "1"]}], 
    SubscriptBox["k", "3"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     SubscriptBox["k", "2"]}], 
    SubscriptBox["k", "3"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     SubscriptBox["k", "1"]}], 
    SubscriptBox["k", "4"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     SubscriptBox["k", "2"]}], 
    SubscriptBox["k", "4"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     SubscriptBox["k", "3"]}], 
    SubscriptBox["k", "4"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["k", "3"]}], 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["k", "4"]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "1"]}], 
    SubscriptBox["k", "5"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "2"]}], 
    SubscriptBox["k", "5"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "3"]}], 
    SubscriptBox["k", "5"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["k", "3"]}], 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["k", "5"]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "4"]}], 
    SubscriptBox["k", "5"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["k", "4"]}], 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["k", "5"]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["k", "4"]}], 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["k", "5"]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["k", "4"]}], 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["k", "5"]}]]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{3.95735191639641*^9, 3.9573520892654943`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"49c48c8f-444a-47f8-85f0-33085537ca0f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Path decomposition", "Subsubsection",
 CellChangeTimes->{{3.957454502058907*^9, 
  3.957454505377376*^9}},ExpressionUUID->"2d632838-738a-4034-afbb-\
d0e0eab6955f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"k", ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ls", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"l", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"1.", " ", "Enumerate", " ", "all", " ", "directed", " ", 
     RowBox[{"paths", ":", "\[Sigma]"}]}], "=", 
    RowBox[{
     RowBox[{"\[PlusMinus]", "1"}], " ", "choice", " ", "at", " ", "each", " ",
      "interface"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"paths", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "NN"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"paths", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"paths", ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", "#", "]"}], " ", "=!=", " ", 
        RowBox[{"-", "1"}]}], " ", "&"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"2", "^", 
     RowBox[{"(", 
      RowBox[{"NN", "-", "1"}], ")"}]}], " ", "rows"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "Amplitude", " ", "coefficient", " ", "A_j", " ", "for", " ", 
    "each", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"path", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
       "--"}], "--"}], "--"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amplitudes", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"paths", "[", 
            RowBox[{"[", 
             RowBox[{"p", ",", 
              RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "*", 
           RowBox[{"paths", "[", 
            RowBox[{"[", 
             RowBox[{"p", ",", "i"}], "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"ks", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], "/", 
            RowBox[{"ks", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ")"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"interface", " ", "factor"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "NN"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"Length", "[", "paths", "]"}]}], "}"}]}], "]"}]}], ";"}], 
"\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cosineTerms", "=", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["k", "ii"], 
           SubscriptBox["l", "ii"]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "NN"}], "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
     "paths"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newMode", "=", 
   RowBox[{"TrigExpand", "[", 
    RowBox[{"Total", "[", 
     RowBox[{"amplitudes", "*", "cosineTerms"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Framed", "[", "newMode", "]"}]}], "Input",
 CellChangeTimes->{{3.9556953243527813`*^9, 3.955695420145878*^9}, {
  3.955696221684177*^9, 3.955696230935664*^9}, {3.9556964634285088`*^9, 
  3.955696466095749*^9}, {3.9572303821244383`*^9, 3.957230387346716*^9}, {
  3.957230511767435*^9, 3.957230519739986*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"1add44f0-0cee-46a8-ae8b-abd4d1cbdabe"],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "1"], " ", 
      SubscriptBox["l", "1"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "2"], " ", 
      SubscriptBox["l", "2"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["l", "3"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "4"], " ", 
      SubscriptBox["l", "4"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["k", "5"], " ", 
      SubscriptBox["l", "5"]}], "]"}]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     SubscriptBox["k", "1"]}], 
    SubscriptBox["k", "2"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     SubscriptBox["k", "1"]}], 
    SubscriptBox["k", "3"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     SubscriptBox["k", "2"]}], 
    SubscriptBox["k", "3"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     SubscriptBox["k", "1"]}], 
    SubscriptBox["k", "4"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     SubscriptBox["k", "2"]}], 
    SubscriptBox["k", "4"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     SubscriptBox["k", "3"]}], 
    SubscriptBox["k", "4"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["k", "3"]}], 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["k", "4"]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "1"]}], 
    SubscriptBox["k", "5"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "2"]}], 
    SubscriptBox["k", "5"]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "3"]}], 
    SubscriptBox["k", "5"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["k", "3"]}], 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["k", "5"]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "4"]}], 
    SubscriptBox["k", "5"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["k", "4"]}], 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["k", "5"]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["k", "4"]}], 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["k", "5"]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["l", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "2"], " ", 
       SubscriptBox["l", "2"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["l", "3"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["l", "4"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["k", "5"], " ", 
       SubscriptBox["l", "5"]}], "]"}], " ", 
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["k", "4"]}], 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["k", "5"]}]]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{3.957351916491664*^9, 3.957352093629325*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"444bf295-9210-470c-b633-fb9a7eb6d70c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare", "Subsubsection",
 CellChangeTimes->{{3.9574545157181396`*^9, 
  3.957454516718204*^9}},ExpressionUUID->"f941b49b-348d-472a-b671-\
a5d188a394f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"newMode", "-", "oldMode"}], "]"}]], "Input",
 CellChangeTimes->{{3.95569642931912*^9, 3.95569644323083*^9}, {
  3.957230531476491*^9, 3.957230534588385*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"fbeddab0-ca91-4863-a1b1-fd45d87acd76"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.957351916509162*^9, 3.9573520961053467`*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"9d1eb3c8-79d9-41f0-81d3-b440f289424b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1386, 851.25},
WindowMargins->{{-2.25, Automatic}, {Automatic, -22.5}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->"/home/aj/Downloads/comparison"},
FrontEndVersion->"14.2 for Linux x86 (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"17688280-164c-4b73-8785-2c3ae2eb3ee7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 261, 4, 65, "Section",ExpressionUUID->"c80aef83-a3f3-491a-8f72-c7615c496e41"],
Cell[844, 28, 624, 14, 33, "Text",ExpressionUUID->"aacbe4da-c175-47a5-a41d-e6d53670c7db"],
Cell[1471, 44, 160, 3, 33, "Text",ExpressionUUID->"3a52fe1c-0b80-4f3c-8349-49ae622fc350"],
Cell[1634, 49, 429, 7, 29, "Input",ExpressionUUID->"43ec1f81-55d1-4b42-82ca-3ef8b7b9ead0"],
Cell[CellGroupData[{
Cell[2088, 60, 173, 3, 43, "Subsubsection",ExpressionUUID->"1bc80a9b-7e38-4c1d-86dc-fed53810c14b"],
Cell[CellGroupData[{
Cell[2286, 67, 5430, 150, 486, "Input",ExpressionUUID->"93b09dea-28a1-4425-b63b-b7ad325fc56f"],
Cell[7719, 219, 11994, 401, 306, "Output",ExpressionUUID->"49c48c8f-444a-47f8-85f0-33085537ca0f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19762, 626, 169, 3, 43, "Subsubsection",ExpressionUUID->"2d632838-738a-4034-afbb-d0e0eab6955f"],
Cell[CellGroupData[{
Cell[19956, 633, 5023, 152, 280, "Input",ExpressionUUID->"1add44f0-0cee-46a8-ae8b-abd4d1cbdabe"],
Cell[24982, 787, 11993, 401, 306, "Output",ExpressionUUID->"444bf295-9210-470c-b633-fb9a7eb6d70c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37024, 1194, 160, 3, 43, "Subsubsection",ExpressionUUID->"f941b49b-348d-472a-b671-a5d188a394f4"],
Cell[CellGroupData[{
Cell[37209, 1201, 288, 5, 29, "Input",ExpressionUUID->"fbeddab0-ca91-4863-a1b1-fd45d87acd76"],
Cell[37500, 1208, 173, 2, 33, "Output",ExpressionUUID->"9d1eb3c8-79d9-41f0-81d3-b440f289424b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

